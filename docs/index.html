<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions and utilities for tidy time series forecasting and time series cross-validation • tscv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Functions and utilities for tidy time series forecasting and time series cross-validation">
<meta property="og:description" content="The package tscv provides a collection of functions and tools for time series 
   analysis and forecasting as well as time series cross-validation. This is mainly a set 
   of wrapper and helper functions as well as some extensions for the packages tsibble, 
   fable and fabletools that I find useful for research in the area of time series forecasting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tscv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette_01_introduction.html">Introduction</a>
    </li>
    <li>
      <a href="articles/vignette_02_cross_validation.html">Time Series Cross Validation</a>
    </li>
    <li>
      <a href="articles/vignette_03_data_visualization.html">Visualization of Time Series Data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ahaeusser/tscv/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="tscv">tscv<a class="anchor" aria-label="anchor" href="#tscv"></a>
</h1></div>
<!-- badges: start -->

<p>The package <code>tscv</code> provides a collection of functions and tools for time series analysis and forecasting as well as time series cross-validation. This is mainly a set of wrapper and helper functions as well as some extensions for the packages <code>tsibble</code>, <code>fable</code> and <code>fabletools</code> that I find useful for research in the area of time series forecasting.</p>
<p><strong><em>Disclaimer:</em></strong> The <code>tscv</code> package is highly experimental and it is very likely that there will be (substantial) changes in the near future.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ahaeusser/tscv"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load relevant packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ahaeusser/tscv" class="external-link">tscv</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsibble.tidyverts.org" class="external-link">tsibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fable.tidyverts.org" class="external-link">fable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://feasts.tidyverts.org/" class="external-link">feasts</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>The data set <code>elec_price</code> is a <code>tibble</code> with day-ahead electricity spot prices in [EUR/MWh] from the ENTSO-E Transparency Platform. The data set contains hourly time series data from 2019-01-01 to 2020-12-31 for 8 European bidding zones (BZN):</p>
<ul>
<li>DE: Germany (including Luxembourg)</li>
<li>DK: Denmark</li>
<li>ES: Spain</li>
<li>FI: Finland</li>
<li>FR: France</li>
<li>NL: Netherlands</li>
<li>NO1: Norway 1 (Oslo)</li>
<li>SE1: Sweden 1 (Lulea)</li>
</ul>
<p>In this vignette, we will use only four time series to demonstrate the functionality of the package (the data set is filtered to the bidding zones Germany, France, Norway and Sweden). You can use the function <code><a href="reference/plot_line.html">plot_line()</a></code> to visualize the four time series. The function <code><a href="reference/summarise_data.html">summarise_data()</a></code> is used to explore the structure (start date, end date, number of observations and the number missing and zero values). The function <code><a href="reference/summarise_stats.html">summarise_stats()</a></code> calculates descriptive statistics for each time series.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">series_id</span> <span class="op">=</span> <span class="st">"bidding_zone"</span>
<span class="va">value_id</span> <span class="op">=</span> <span class="st">"value"</span>
<span class="va">index_id</span> <span class="op">=</span> <span class="st">"time"</span>

<span class="va">context</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  series_id <span class="op">=</span> <span class="va">series_id</span>,
  value_id <span class="op">=</span> <span class="va">value_id</span>,
  index_id <span class="op">=</span> <span class="va">index_id</span>
<span class="op">)</span>

<span class="co"># Prepare data set</span>
<span class="va">main_frame</span> <span class="op">&lt;-</span> <span class="va">elec_price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bidding_zone</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DE"</span>, <span class="st">"FR"</span>, <span class="st">"NO1"</span>, <span class="st">"SE1"</span><span class="op">)</span><span class="op">)</span>

<span class="va">main_frame</span>
<span class="co">#&gt; # A tibble: 70,176 x 5</span>
<span class="co">#&gt;    time                item            unit      bidding_zone  value</span>
<span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2019-01-01 00:00:00 Day-ahead Price [EUR/MWh] DE            10.1 </span>
<span class="co">#&gt;  2 2019-01-01 01:00:00 Day-ahead Price [EUR/MWh] DE            -4.08</span>
<span class="co">#&gt;  3 2019-01-01 02:00:00 Day-ahead Price [EUR/MWh] DE            -9.91</span>
<span class="co">#&gt;  4 2019-01-01 03:00:00 Day-ahead Price [EUR/MWh] DE            -7.41</span>
<span class="co">#&gt;  5 2019-01-01 04:00:00 Day-ahead Price [EUR/MWh] DE           -12.6 </span>
<span class="co">#&gt;  6 2019-01-01 05:00:00 Day-ahead Price [EUR/MWh] DE           -17.2 </span>
<span class="co">#&gt;  7 2019-01-01 06:00:00 Day-ahead Price [EUR/MWh] DE           -15.1 </span>
<span class="co">#&gt;  8 2019-01-01 07:00:00 Day-ahead Price [EUR/MWh] DE            -4.93</span>
<span class="co">#&gt;  9 2019-01-01 08:00:00 Day-ahead Price [EUR/MWh] DE            -6.33</span>
<span class="co">#&gt; 10 2019-01-01 09:00:00 Day-ahead Price [EUR/MWh] DE            -4.93</span>
<span class="co">#&gt; # ... with 70,166 more rows</span>

<span class="va">main_frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/plot_line.html">plot_line</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">time</span>,
    y <span class="op">=</span> <span class="va">value</span>,
    color <span class="op">=</span> <span class="va">bidding_zone</span>,
    facet_var <span class="op">=</span> <span class="va">bidding_zone</span>,
    title <span class="op">=</span> <span class="st">"Day-ahead Electricity Spot Price"</span>,
    subtitle <span class="op">=</span> <span class="st">"2019-01-01 to 2020-12-31"</span>,
    xlab <span class="op">=</span> <span class="st">"Time"</span>,
    ylab <span class="op">=</span> <span class="st">"[EUR/MWh]"</span>,
    caption <span class="op">=</span> <span class="st">"Data: ENTSO-E Transparency"</span>
    <span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-clean_data-1.svg" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/summarise_data.html">summarise_data</a></span><span class="op">(</span>
  .data <span class="op">=</span> <span class="va">main_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 8</span>
<span class="co">#&gt;   bidding_zone start               end                 n_obs n_missing</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;dttm&gt;              &lt;dttm&gt;              &lt;int&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 DE           2019-01-01 00:00:00 2020-12-31 23:00:00 17544         0</span>
<span class="co">#&gt; 2 FR           2019-01-01 00:00:00 2020-12-31 23:00:00 17544         0</span>
<span class="co">#&gt; 3 NO1          2019-01-01 00:00:00 2020-12-31 23:00:00 17544         0</span>
<span class="co">#&gt; 4 SE1          2019-01-01 00:00:00 2020-12-31 23:00:00 17544         0</span>
<span class="co">#&gt; # ... with 3 more variables: pct_missing &lt;dbl&gt;, n_zeros &lt;int&gt;, pct_zeros &lt;dbl&gt;</span>

<span class="fu"><a href="reference/summarise_stats.html">summarise_stats</a></span><span class="op">(</span>
  .data <span class="op">=</span> <span class="va">main_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 11</span>
<span class="co">#&gt;   bidding_zone  mean median  mode    sd     p0   p25   p75  p100 skewness</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 DE            34.1   35.1 35.9   16.9 -90.0  26.3   43.8  200.   -0.776</span>
<span class="co">#&gt; 2 FR            35.8   36   37.2   15.5 -75.8  26.6   44.9  200.    0.323</span>
<span class="co">#&gt; 3 NO1           24.3   26.9  2.66  17.1  -1.73  6.95  38.8  109.    0.189</span>
<span class="co">#&gt; 4 SE1           26.1   27.9 37.9   15.9  -1.73 11.4   38.5  189.    0.378</span>
<span class="co">#&gt; # ... with 1 more variable: kurtosis &lt;dbl&gt;</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="split-data-into-training-and-testing">Split data into training and testing<a class="anchor" aria-label="anchor" href="#split-data-into-training-and-testing"></a>
</h2>
<p>To prepare the data set for time series cross-validation (TSCV), you can use the function <code><a href="reference/make_split.html">make_split()</a></code>. This function splits the data into several slices for training and testing (i.e. partitioning into time slices) for time series cross-validation. You can choose between <code>stretch</code> and <code>slide</code>. The first is an expanding window approach, while the latter is a fixed window approach. Furthermore, we define the (initial) window size for training and testing via <code>n_init</code> and <code>n_ahead</code>, as well as the step size for increments via <code>n_skip</code>. Further options for splitting the data are available via <code>type</code> (see function reference for more details).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Setup for time series cross validation</span>
<span class="va">type</span> <span class="op">=</span> <span class="st">"first"</span>
<span class="va">value</span> <span class="op">=</span> <span class="fl">2400</span>      <span class="co"># size for training window</span>
<span class="va">n_ahead</span> <span class="op">=</span> <span class="fl">24</span>      <span class="co"># size for testing window (= forecast horizon)</span>
<span class="va">n_skip</span> <span class="op">=</span> <span class="fl">23</span>       <span class="co"># skip 23 observations</span>
<span class="va">n_lag</span> <span class="op">=</span> <span class="fl">0</span>         <span class="co"># no lag</span>
<span class="va">mode</span> <span class="op">=</span> <span class="st">"slide"</span>    <span class="co"># fixed window approach</span>
<span class="va">exceed</span> <span class="op">=</span> <span class="cn">FALSE</span>    <span class="co"># only pseudo out-of-sample forecast</span>

<span class="va">split_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_split.html">make_split</a></span><span class="op">(</span>
  main_frame <span class="op">=</span> <span class="va">main_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>,
  type <span class="op">=</span> <span class="va">type</span>,
  value <span class="op">=</span> <span class="va">value</span>,
  n_ahead <span class="op">=</span> <span class="va">n_ahead</span>,
  n_skip <span class="op">=</span> <span class="va">n_skip</span>,
  n_lag <span class="op">=</span> <span class="va">n_lag</span>,
  mode <span class="op">=</span> <span class="va">mode</span>,
  exceed <span class="op">=</span> <span class="va">exceed</span>
<span class="op">)</span>

<span class="co"># For illustration, only the first 50 splits are used</span>
<span class="va">split_frame</span> <span class="op">&lt;-</span> <span class="va">split_frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">split</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>

<span class="va">split_frame</span>
<span class="co">#&gt; # A tibble: 200 x 4</span>
<span class="co">#&gt;    bidding_zone split train         test      </span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;int&gt; &lt;list&gt;        &lt;list&gt;    </span>
<span class="co">#&gt;  1 DE               1 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  2 DE               2 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  3 DE               3 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  4 DE               4 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  5 DE               5 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  6 DE               6 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  7 DE               7 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  8 DE               8 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt;  9 DE               9 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt; 10 DE              10 &lt;int [2,400]&gt; &lt;int [24]&gt;</span>
<span class="co">#&gt; # ... with 190 more rows</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="training-and-forecasting">Training and forecasting<a class="anchor" aria-label="anchor" href="#training-and-forecasting"></a>
</h2>
<p>The training and test splits are prepared within <code>split_frame</code> and we are ready for forecasting. The function <code><a href="reference/slice_train.html">slice_train()</a></code> slices the data <code>main_frame</code> according to the splits within <code>split_frame</code>. As we are using forecasting methods from the packages <code>fable</code> and <code>fabletools</code>, we have to convert the data set <code>main_frame</code> from a <code>tibble</code> to a <code>tsibble</code>. Due to the sample size and computation time, only very simple benchmark methods are used:</p>
<ul>
<li>
<code>SNAIVE</code>: Seasonal naive model with weekly seasonality (from package <code>fable</code>)</li>
<li>
<code>STL-NAIVE</code>: STL-decomposition model and naive forecast. The series is decomposed via STL and the seasonal adjusted series is predicted via the naive approach. Afterwards, seasonal component is added to the forecasts (from packages <code>fable</code> and <code>feasts</code>)</li>
<li>
<code>SNAIVE2</code>: Variation of the seasonal naive approach. Mondays, Saturdays and Sundays are treated with a weekly lag. Tuesdays, Wednesdays, Thursdays and Fridays are treated with a daily lag.</li>
<li>
<code>SMEDIAN</code>: Seasonal median model</li>
</ul>
<p>The functions <code><a href="reference/SMEDIAN.html">SMEDIAN()</a></code> and <code><a href="reference/SNAIVE2.html">SNAIVE2()</a></code> are extensions to the <code>fable</code> package</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Slice training data from main_frame according to split_frame</span>
<span class="va">train_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/slice_train.html">slice_train</a></span><span class="op">(</span>
  main_frame <span class="op">=</span> <span class="va">main_frame</span>,
  split_frame <span class="op">=</span> <span class="va">split_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>
  <span class="op">)</span>

<span class="va">train_frame</span>
<span class="co">#&gt; # A tibble: 480,000 x 6</span>
<span class="co">#&gt;    time                item            unit      bidding_zone  value split</span>
<span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt;  1 2019-01-01 00:00:00 Day-ahead Price [EUR/MWh] DE            10.1      1</span>
<span class="co">#&gt;  2 2019-01-01 01:00:00 Day-ahead Price [EUR/MWh] DE            -4.08     1</span>
<span class="co">#&gt;  3 2019-01-01 02:00:00 Day-ahead Price [EUR/MWh] DE            -9.91     1</span>
<span class="co">#&gt;  4 2019-01-01 03:00:00 Day-ahead Price [EUR/MWh] DE            -7.41     1</span>
<span class="co">#&gt;  5 2019-01-01 04:00:00 Day-ahead Price [EUR/MWh] DE           -12.6      1</span>
<span class="co">#&gt;  6 2019-01-01 05:00:00 Day-ahead Price [EUR/MWh] DE           -17.2      1</span>
<span class="co">#&gt;  7 2019-01-01 06:00:00 Day-ahead Price [EUR/MWh] DE           -15.1      1</span>
<span class="co">#&gt;  8 2019-01-01 07:00:00 Day-ahead Price [EUR/MWh] DE            -4.93     1</span>
<span class="co">#&gt;  9 2019-01-01 08:00:00 Day-ahead Price [EUR/MWh] DE            -6.33     1</span>
<span class="co">#&gt; 10 2019-01-01 09:00:00 Day-ahead Price [EUR/MWh] DE            -4.93     1</span>
<span class="co">#&gt; # ... with 479,990 more rows</span>

<span class="co"># Convert tibble to tsibble</span>
<span class="va">train_frame</span> <span class="op">&lt;-</span> <span class="va">train_frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span>
    index <span class="op">=</span> <span class="va">time</span>,
    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bidding_zone</span>, <span class="va">split</span><span class="op">)</span>
    <span class="op">)</span>

<span class="va">train_frame</span>
<span class="co">#&gt; # A tsibble: 480,000 x 6 [1h] &lt;UTC&gt;</span>
<span class="co">#&gt; # Key:       bidding_zone, split [200]</span>
<span class="co">#&gt;    time                item            unit      bidding_zone  value split</span>
<span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt;  1 2019-01-01 00:00:00 Day-ahead Price [EUR/MWh] DE            10.1      1</span>
<span class="co">#&gt;  2 2019-01-01 01:00:00 Day-ahead Price [EUR/MWh] DE            -4.08     1</span>
<span class="co">#&gt;  3 2019-01-01 02:00:00 Day-ahead Price [EUR/MWh] DE            -9.91     1</span>
<span class="co">#&gt;  4 2019-01-01 03:00:00 Day-ahead Price [EUR/MWh] DE            -7.41     1</span>
<span class="co">#&gt;  5 2019-01-01 04:00:00 Day-ahead Price [EUR/MWh] DE           -12.6      1</span>
<span class="co">#&gt;  6 2019-01-01 05:00:00 Day-ahead Price [EUR/MWh] DE           -17.2      1</span>
<span class="co">#&gt;  7 2019-01-01 06:00:00 Day-ahead Price [EUR/MWh] DE           -15.1      1</span>
<span class="co">#&gt;  8 2019-01-01 07:00:00 Day-ahead Price [EUR/MWh] DE            -4.93     1</span>
<span class="co">#&gt;  9 2019-01-01 08:00:00 Day-ahead Price [EUR/MWh] DE            -6.33     1</span>
<span class="co">#&gt; 10 2019-01-01 09:00:00 Day-ahead Price [EUR/MWh] DE            -4.93     1</span>
<span class="co">#&gt; # ... with 479,990 more rows</span>

<span class="co"># Model training via fabletools::model()</span>
<span class="va">model_frame</span> <span class="op">&lt;-</span> <span class="va">train_frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html" class="external-link">model</a></span><span class="op">(</span>
    <span class="st">"SNAIVE"</span> <span class="op">=</span> <span class="fu"><a href="https://fable.tidyverts.org/reference/RW.html" class="external-link">SNAIVE</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="st">"week"</span><span class="op">)</span><span class="op">)</span>,
    <span class="st">"STL-NAIVE"</span> <span class="op">=</span> <span class="fu"><a href="https://fabletools.tidyverts.org/reference/decomposition_model.html" class="external-link">decomposition_model</a></span><span class="op">(</span><span class="fu"><a href="https://feasts.tidyverts.org/reference/STL.html" class="external-link">STL</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="fu"><a href="https://fable.tidyverts.org/reference/RW.html" class="external-link">NAIVE</a></span><span class="op">(</span><span class="va">season_adjust</span><span class="op">)</span><span class="op">)</span>,
    <span class="st">"SNAIVE2"</span> <span class="op">=</span> <span class="fu"><a href="reference/SNAIVE2.html">SNAIVE2</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,
    <span class="st">"SMEDIAN"</span> <span class="op">=</span> <span class="fu"><a href="reference/SMEDIAN.html">SMEDIAN</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="st">"week"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>

<span class="va">model_frame</span>
<span class="co">#&gt; # A mable: 200 x 6</span>
<span class="co">#&gt; # Key:     bidding_zone, split [200]</span>
<span class="co">#&gt;    bidding_zone split   SNAIVE               `STL-NAIVE`   SNAIVE2   SMEDIAN</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;int&gt;  &lt;model&gt;                   &lt;model&gt;   &lt;model&gt;   &lt;model&gt;</span>
<span class="co">#&gt;  1 DE               1 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  2 DE               2 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  3 DE               3 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  4 DE               4 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  5 DE               5 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  6 DE               6 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  7 DE               7 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  8 DE               8 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt;  9 DE               9 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt; 10 DE              10 &lt;SNAIVE&gt; &lt;STL decomposition model&gt; &lt;SNAIVE2&gt; &lt;SMEDIAN&gt;</span>
<span class="co">#&gt; # ... with 190 more rows</span>

<span class="co"># Forecasting via fabletools::forecast()</span>
<span class="va">fable_frame</span> <span class="op">&lt;-</span> <span class="va">model_frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://fabletools.tidyverts.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">n_ahead</span><span class="op">)</span>

<span class="va">fable_frame</span>
<span class="co">#&gt; # A fable: 19,200 x 6 [1h] &lt;UTC&gt;</span>
<span class="co">#&gt; # Key:     bidding_zone, split, .model [800]</span>
<span class="co">#&gt;    bidding_zone split .model time                     value .mean</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;  &lt;dttm&gt;                  &lt;dist&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DE               1 SNAIVE 2019-04-11 00:00:00 N(33, 367)  33  </span>
<span class="co">#&gt;  2 DE               1 SNAIVE 2019-04-11 01:00:00 N(33, 367)  32.6</span>
<span class="co">#&gt;  3 DE               1 SNAIVE 2019-04-11 02:00:00 N(34, 367)  34.1</span>
<span class="co">#&gt;  4 DE               1 SNAIVE 2019-04-11 03:00:00 N(37, 367)  36.9</span>
<span class="co">#&gt;  5 DE               1 SNAIVE 2019-04-11 04:00:00 N(45, 367)  44.7</span>
<span class="co">#&gt;  6 DE               1 SNAIVE 2019-04-11 05:00:00 N(54, 367)  53.6</span>
<span class="co">#&gt;  7 DE               1 SNAIVE 2019-04-11 06:00:00 N(60, 367)  59.9</span>
<span class="co">#&gt;  8 DE               1 SNAIVE 2019-04-11 07:00:00 N(47, 367)  46.9</span>
<span class="co">#&gt;  9 DE               1 SNAIVE 2019-04-11 08:00:00 N(48, 367)  48  </span>
<span class="co">#&gt; 10 DE               1 SNAIVE 2019-04-11 09:00:00 N(47, 367)  47  </span>
<span class="co">#&gt; # ... with 19,190 more rows</span>

<span class="co"># Convert fable_frame (fable) to future_frame (tibble)</span>
<span class="va">future_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_future.html">make_future</a></span><span class="op">(</span>
  fable <span class="op">=</span> <span class="va">fable_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>
  <span class="op">)</span>

<span class="va">future_frame</span>
<span class="co">#&gt; # A tibble: 19,200 x 6</span>
<span class="co">#&gt;    time                bidding_zone model  split horizon point</span>
<span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;        &lt;chr&gt;  &lt;int&gt;   &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2019-04-11 00:00:00 DE           SNAIVE     1       1  33  </span>
<span class="co">#&gt;  2 2019-04-11 01:00:00 DE           SNAIVE     1       2  32.6</span>
<span class="co">#&gt;  3 2019-04-11 02:00:00 DE           SNAIVE     1       3  34.1</span>
<span class="co">#&gt;  4 2019-04-11 03:00:00 DE           SNAIVE     1       4  36.9</span>
<span class="co">#&gt;  5 2019-04-11 04:00:00 DE           SNAIVE     1       5  44.7</span>
<span class="co">#&gt;  6 2019-04-11 05:00:00 DE           SNAIVE     1       6  53.6</span>
<span class="co">#&gt;  7 2019-04-11 06:00:00 DE           SNAIVE     1       7  59.9</span>
<span class="co">#&gt;  8 2019-04-11 07:00:00 DE           SNAIVE     1       8  46.9</span>
<span class="co">#&gt;  9 2019-04-11 08:00:00 DE           SNAIVE     1       9  48  </span>
<span class="co">#&gt; 10 2019-04-11 09:00:00 DE           SNAIVE     1      10  47  </span>
<span class="co">#&gt; # ... with 19,190 more rows</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluation-of-forecast-accuracy">Evaluation of forecast accuracy<a class="anchor" aria-label="anchor" href="#evaluation-of-forecast-accuracy"></a>
</h2>
<p>To evaluate the forecast accuracy, the function <code><a href="reference/make_accuracy.html">make_accuracy()</a></code> is used. You can define whether to evaluate the accuracy by <code>horizon</code> or by <code>split</code>. Several accuracy metrics are available:</p>
<ul>
<li>
<code>ME</code>: mean error</li>
<li>
<code>MAE</code>: mean absolute error</li>
<li>
<code>MSE</code>: mean squared error</li>
<li>
<code>RMSE</code>: root mean squared error</li>
<li>
<code>MAPE</code>: mean absolute percentage error</li>
<li>
<code>sMAPE</code>: scaled mean absolute percentage error</li>
<li>
<code>MPE</code>: mean percentage error</li>
<li>
<code>rMAE</code>: relative mean absolute error (relative to some user-defined benchmark method)</li>
</ul>
<div class="section level3">
<h3 id="forecast-accuracy-by-forecast-horizon">Forecast accuracy by forecast horizon<a class="anchor" aria-label="anchor" href="#forecast-accuracy-by-forecast-horizon"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate accuracy metrics by forecast horizon</span>
<span class="va">accuracy_horizon</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_accuracy.html">make_accuracy</a></span><span class="op">(</span>
  future_frame <span class="op">=</span> <span class="va">future_frame</span>,
  main_frame <span class="op">=</span> <span class="va">main_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>,
  dimension <span class="op">=</span> <span class="st">"horizon"</span>
<span class="op">)</span>

<span class="va">accuracy_horizon</span>
<span class="co">#&gt; # A tibble: 2,688 x 6</span>
<span class="co">#&gt;    bidding_zone model   dimension     n metric value</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DE           SMEDIAN horizon       1 MAE     4.84</span>
<span class="co">#&gt;  2 DE           SMEDIAN horizon       2 MAE     5.05</span>
<span class="co">#&gt;  3 DE           SMEDIAN horizon       3 MAE     4.85</span>
<span class="co">#&gt;  4 DE           SMEDIAN horizon       4 MAE     4.50</span>
<span class="co">#&gt;  5 DE           SMEDIAN horizon       5 MAE     6.73</span>
<span class="co">#&gt;  6 DE           SMEDIAN horizon       6 MAE     6.66</span>
<span class="co">#&gt;  7 DE           SMEDIAN horizon       7 MAE     6.40</span>
<span class="co">#&gt;  8 DE           SMEDIAN horizon       8 MAE     6.73</span>
<span class="co">#&gt;  9 DE           SMEDIAN horizon       9 MAE     7.38</span>
<span class="co">#&gt; 10 DE           SMEDIAN horizon      10 MAE     9.06</span>
<span class="co">#&gt; # ... with 2,678 more rows</span>

<span class="co"># Visualize results</span>
<span class="va">accuracy_horizon</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metric</span> <span class="op">==</span> <span class="st">"MAE"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/plot_line.html">plot_line</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">n</span>,
    y <span class="op">=</span> <span class="va">value</span>,
    facet_var <span class="op">=</span> <span class="va">bidding_zone</span>,
    facet_nrow <span class="op">=</span> <span class="fl">1</span>,
    color <span class="op">=</span> <span class="va">model</span>,
    title <span class="op">=</span> <span class="st">"Evaluation of forecast accuracy by forecast horizon"</span>,
    subtitle <span class="op">=</span> <span class="st">"Mean absolute error (MAE)"</span>,
    xlab <span class="op">=</span> <span class="st">"Forecast horizon (n-step-ahead)"</span>,
    caption <span class="op">=</span> <span class="st">"Data: ENTSO-E Transparency, own calculation"</span>
    <span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-accuracy_horizon-1.svg" width="100%"></p>
</div>
<div class="section level3">
<h3 id="forecast-accuracy-by-split">Forecast accuracy by split<a class="anchor" aria-label="anchor" href="#forecast-accuracy-by-split"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate accuracy metrics by forecast horizon</span>
<span class="va">accuracy_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_accuracy.html">make_accuracy</a></span><span class="op">(</span>
  future_frame <span class="op">=</span> <span class="va">future_frame</span>,
  main_frame <span class="op">=</span> <span class="va">main_frame</span>,
  context <span class="op">=</span> <span class="va">context</span>,
  dimension <span class="op">=</span> <span class="st">"split"</span>
<span class="op">)</span>

<span class="va">accuracy_split</span>
<span class="co">#&gt; # A tibble: 5,600 x 6</span>
<span class="co">#&gt;    bidding_zone model   dimension     n metric value</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DE           SMEDIAN split         1 MAE     2.80</span>
<span class="co">#&gt;  2 DE           SMEDIAN split         2 MAE     3.74</span>
<span class="co">#&gt;  3 DE           SMEDIAN split         3 MAE     2.70</span>
<span class="co">#&gt;  4 DE           SMEDIAN split         4 MAE     2.53</span>
<span class="co">#&gt;  5 DE           SMEDIAN split         5 MAE     4.54</span>
<span class="co">#&gt;  6 DE           SMEDIAN split         6 MAE     3.78</span>
<span class="co">#&gt;  7 DE           SMEDIAN split         7 MAE     4.38</span>
<span class="co">#&gt;  8 DE           SMEDIAN split         8 MAE     4.87</span>
<span class="co">#&gt;  9 DE           SMEDIAN split         9 MAE    11.5 </span>
<span class="co">#&gt; 10 DE           SMEDIAN split        10 MAE     5.02</span>
<span class="co">#&gt; # ... with 5,590 more rows</span>

<span class="co"># Visualize results</span>
<span class="va">accuracy_split</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metric</span> <span class="op">==</span> <span class="st">"MAE"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/plot_line.html">plot_line</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">n</span>,
    y <span class="op">=</span> <span class="va">value</span>,
    facet_var <span class="op">=</span> <span class="va">bidding_zone</span>,
    facet_nrow <span class="op">=</span> <span class="fl">1</span>,
    color <span class="op">=</span> <span class="va">model</span>,
    title <span class="op">=</span> <span class="st">"Evaluation of forecast accuracy by split"</span>,
    subtitle <span class="op">=</span> <span class="st">"Mean absolute error (MAE)"</span>,
    xlab <span class="op">=</span> <span class="st">"Split"</span>,
    caption <span class="op">=</span> <span class="st">"Data: ENTSO-E Transparency, own calculation"</span>
    <span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-accuracy_split-1.svg" width="100%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ahaeusser/tscv/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ahaeusser/tscv/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tscv</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Häußer <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="external-link"><img src="https://img.shields.io/badge/licence-GPL--3-blue.svg" alt="Licence"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Häußer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
